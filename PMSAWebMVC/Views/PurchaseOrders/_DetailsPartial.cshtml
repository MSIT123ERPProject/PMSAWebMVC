@model PMSAWebMVC.ViewModels.PurchaseOrders.POSendToSupplierViewModel.SendToSupplierViewModel

@*採購單資訊*@
<div class="card mb-3">
    <div class="card-header">
        <a data-toggle="collapse" href="#collapse-roinfo" aria-expanded="true" aria-controls="collapse-roinfo" id="heading-roinfo" class="d-block nounderline">
            <i class="fab fa-wpforms"></i> 採購單資訊 <i class="fa fa-chevron-down"></i>
        </a>
    </div>

    <div id="collapse-roinfo" class="collapse show" aria-labelledby="heading-roinfo">
        <div class="card-body pt-2 pb-0">
            <div class="row">
                <div class="col-md-3 col-6">
                    <small><strong>@Html.DisplayNameFor(model => Model.POItem.PurchaseOrderID)</strong></small>
                    <br>
                    <p class="text-muted">@Html.DisplayFor(model => Model.POItem.PurchaseOrderID)</p>
                </div>
                <div class="col-md-3 col-6">
                    <small><strong>@Html.DisplayNameFor(model => Model.POItem.Buyer)</strong></small>
                    <br>
                    <p class="text-muted">@Html.DisplayFor(model => Model.POItem.Buyer)</p>
                </div>
                <div class="col-md-3 col-6">
                    <small><strong>@Html.DisplayNameFor(model => Model.POItem.Email)</strong></small>
                    <br>
                    <p class="text-muted">@Html.DisplayFor(model => Model.POItem.Email)</p>
                </div>
                <div class="col-md-3 col-6">
                    <small><strong>@Html.DisplayNameFor(model => Model.POItem.Tel)</strong></small>
                    <br>
                    <p class="text-muted">@Html.DisplayFor(model => Model.POItem.Tel)</p>
                </div>
                <div class="col-md-3 col-6">
                    <small><strong>@Html.DisplayNameFor(model => Model.POItem.PurchaseRequisitionID)</strong></small>
                    <br>
                    <p class="text-muted">@Html.DisplayFor(model => Model.POItem.PurchaseRequisitionID)</p>
                </div>
                <div class="col-md-3 col-6">
                    <small><strong>@Html.DisplayNameFor(model => Model.POItem.CreateDate)</strong></small>
                    <br>
                    <p class="text-muted">@Html.DisplayFor(model => Model.POItem.CreateDate)</p>
                </div>
                <div class="col-md-3 col-6">
                    <small><strong>@Html.DisplayNameFor(model => Model.POItem.PurchaseOrderStatus)</strong></small>
                    <br>
                    <p class="text-muted">@Html.DisplayFor(model => Model.POItem.PurchaseOrderStatus)</p>
                </div>
                <div class="col-md-3 col-6">
                    <small><strong>@Html.DisplayNameFor(model => Model.POItem.SignStatusToShow)</strong></small>
                    <br>
                    <div class="d-flex flex-row">
                        <p class="text-muted">@Html.DisplayFor(model => Model.POItem.SignStatusToShow)</p>
                        @if (Model.SFItem != null)
                        {
                            <div class="table-data-feature">
                                <div class="dropdown" data-toggle="popover-dropdown">
                                    <button class="btn btn-icon">
                                        <i class="ik ik-info"></i>
                                    </button>
                                    <div class="dropdown-menu">
                                        @if ("YN".Contains(Model.SFItem.SignStatus))
                                        {
                                            <div class="dropdown-item d-flex justify-content-between align-items-start border-bottom">
                                                <strong>@Html.DisplayNameFor(model => Model.SFItem.ApprovingOfficerName)</strong><span class="ml-3">@Html.DisplayFor(model => Model.SFItem.ApprovingOfficerName)</span>
                                            </div>
                                            <div class="dropdown-item d-flex justify-content-between align-items-start border-bottom">
                                                <strong>@Html.DisplayNameFor(model => Model.SFItem.SignDate)</strong><span class="ml-3">@Html.DisplayFor(model => Model.SFItem.SignDate)</span>
                                            </div>
                                            <div class="dropdown-item d-flex justify-content-between align-items-start">
                                                <strong>@Html.DisplayNameFor(model => Model.SFItem.SignOpinion)</strong><span class="ml-3">
                                                    @if (string.IsNullOrWhiteSpace(Model.SFItem.SignOpinion))
                                                    {
                                                        @:無
                                                    }
                                                    else
                                                    {
                                                        @Html.DisplayFor(model => Model.SFItem.SignOpinion)
                                                    }
                                                </span>
                                            </div>
                                        }
                                        else
                                        {
                                            <div class="dropdown-item d-flex justify-content-between align-items-start border-bottom">
                                                <strong>@Html.DisplayNameFor(model => Model.SFItem.SignBeginDate)</strong><span class="ml-3">@Html.DisplayFor(model => Model.SFItem.SignBeginDate)</span>
                                            </div>
                                            <div class="dropdown-item d-flex justify-content-between align-items-start">
                                                <strong>@Html.DisplayNameFor(model => Model.SFItem.ApprovingOfficerName)</strong><span class="ml-3">@Html.DisplayFor(model => Model.SFItem.ApprovingOfficerName)</span>
                                            </div>
                                        }
                                    </div>
                                </div>
                            </div>
                        }

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@*供應商資訊*@
<div class="card mb-3">
    <div class="card-header">
        <a data-toggle="collapse" href="#collapse-supplierinfo" aria-expanded="true" aria-controls="collapse-supplierinfo" id="heading-supplierinfo" class="d-block nounderline">
            <i class="far fa-building"></i> 供應商<i class="fa fa-chevron-down"></i>
        </a>
    </div>

    <div id="collapse-supplierinfo" class="collapse show" aria-labelledby="heading-supplierinfo">
        <div class="card-body pt-2 pb-0">
            <div class="row">
                <div class="col-md-3 col-6">
                    <small><strong>@Html.DisplayNameFor(m => m.SUPItem.SupplierName)</strong></small>
                    <br>
                    <p class="text-muted">@Html.DisplayFor(m => m.SUPItem.SupplierName)</p>
                </div>
                <div class="col-md-3 col-6">
                    <small><strong>@Html.DisplayNameFor(m => m.SUPItem.ContactName)</strong></small>
                    <br>
                    <p class="text-muted">@Html.DisplayFor(m => m.SUPItem.ContactName)</p>
                </div>
                <div class="col-md-3 col-6">
                    <small><strong>@Html.DisplayNameFor(m => m.SUPItem.Email)</strong></small>
                    <br>
                    <p class="text-muted">@Html.DisplayFor(m => m.SUPItem.Email)</p>
                </div>
                <div class="col-md-3 col-6">
                    <small><strong>@Html.DisplayNameFor(m => m.SUPItem.Tel)</strong></small>
                    <br>
                    <p class="text-muted">@Html.DisplayFor(m => m.SUPItem.Tel)</p>
                </div>
            </div>
        </div>
    </div>
</div>

@*採購明細*@
<div class="card mb-3">
    <div class="card-header">
        <a data-toggle="collapse" href="#collapse-podsinfo" aria-expanded="true" aria-controls="collapse-podsinfo" id="heading-podsinfo" class="d-block nounderline">
            <i class="fas fa-file-invoice-dollar"></i> 採購明細<i class="fa fa-chevron-down"></i>
        </a>
    </div>

    <div id="collapse-podsinfo" class="collapse show" aria-labelledby="heading-podsinfo">
        <div class="card-body pb-0 pt-2">
            <table id="dataTablesPO" class="display table table-striped hover order-column nowrap text-left" style="width:100%">
                <thead>
                    <tr class="bg-primary text-white text-center">
                        <th>&nbsp;</th>
                        <th data-priority="1">@Html.DisplayNameFor(m => m.PODItems.FirstOrDefault().PurchaseOrderDtlCode)</thdata-priority="1">
                        <th>@Html.DisplayNameFor(m => m.PODItems.FirstOrDefault().PartName)</th>
                        <th>@Html.DisplayNameFor(m => m.PODItems.FirstOrDefault().DateRequired)</th>
                        <th>@Html.DisplayNameFor(m => m.PODItems.FirstOrDefault().OriginalUnitPrice)</th>
                        <th>@Html.DisplayNameFor(m => m.PODItems.FirstOrDefault().Qty)</th>
                        <th>@Html.DisplayNameFor(m => m.PODItems.FirstOrDefault().Discount)</th>
                        <th data-priority="1">@Html.DisplayNameFor(m => m.PODItems.FirstOrDefault().Total)</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.PODItems)
                    {
                        <tr>
                            <td></td>
                            <td> @Html.DisplayFor(m => item.PurchaseOrderDtlCode) </td>
                            <td> @Html.DisplayFor(m => item.PartName) </td>
                            <td> @Html.DisplayFor(m => item.DateRequired) </td>
                            <td> @Html.DisplayFor(m => item.OriginalUnitPrice) </td>
                            <td> @Html.DisplayFor(m => item.Qty) </td>
                            <td> @Html.DisplayFor(m => item.Discount) </td>
                            <td> @Html.DisplayFor(m => item.Total) </td>
                        </tr>
                    }
                </tbody>
            </table>

            <div class="d-flex justify-content-between align-items-center border-top-dashed col-12 p-2">
                <p class="mb-1">@Html.DisplayNameFor(m => Model.PODItemsAggregate)</p><p class="mb-1">@Html.DisplayFor(m => Model.PODItemsAggregate)</p>
            </div>
        </div>
    </div>
</div>

@*交貨資訊*@
<div class="card mb-3">
    <div class="card-header">
        <a data-toggle="collapse" href="#collapse-receiverinfo" aria-expanded="true" aria-controls="collapse-receiverinfo" id="heading-receiverinfo" class="d-block nounderline">
            <i class="fas fa-truck-moving"></i> 交貨資訊<i class="fa fa-chevron-down"></i>
        </a>
    </div>

    <div id="collapse-receiverinfo" class="collapse show" aria-labelledby="heading-receiverinfo">
        <div class="card-body pb-0 pt-2">
            <div class="row">
                <div class="col-md-3 col-6">
                    <small><strong>@Html.DisplayNameFor(m => m.POItem.ReceiverName)</strong></small>
                    <br>
                    <p class="text-muted">@Html.DisplayFor(m => m.POItem.ReceiverName)</p>
                </div>
                <div class="col-md-6 col-6">
                    <small><strong>@Html.DisplayNameFor(m => m.POItem.ReceiptAddress)</strong></small>
                    <br>
                    <p class="text-muted">@Html.DisplayFor(m => m.POItem.ReceiptAddress)</p>
                </div>

                <div class="w-100"></div>

                <div class="col-md-3 col-6">
                    <small><strong>@Html.DisplayNameFor(m => m.POItem.ReceiverTel)</strong></small>
                    <br>
                    <p class="text-muted">
                        @if (String.IsNullOrEmpty(Model.POItem.ReceiverTel))
                        {
                            @:無
                        }
                        else
                        {
                            @Html.DisplayFor(m => m.POItem.ReceiverTel)
                        }
                    </p>
                </div>
                <div class="col-md-3 col-6">
                    <small><strong>@Html.DisplayNameFor(m => m.POItem.ReceiverMobile)</strong></small>
                    <br>
                    <p class="text-muted">
                        @if (String.IsNullOrEmpty(Model.POItem.ReceiverMobile))
                        {
                            @:無
                        }
                        else
                        {
                            @Html.DisplayFor(m => m.POItem.ReceiverMobile)
                        }
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="card mb-3">
    <div class="card-header">
        <a data-toggle="collapse" href="#collapse-pochangedrecord" aria-expanded="true" aria-controls="collapse-pochangedrecord" id="heading-pochangedrecord" class="d-block nounderline">
            <i class="far fa-clipboard"></i> 交易記錄<i class="fa fa-chevron-down"></i>
        </a>
    </div>

    <div id="collapse-pochangedrecord" class="collapse show" aria-labelledby="heading-pochangedrecord">
        <div class="card-body pb-0 pt-2">
            <div class="row">
                <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 col-12">
                    <ul class="timeline">
                        @foreach (var item in Model.POChangedItems)
                        {
                            <li>
                                <span class="text-primary">
                                    <span class="badge
                                          @if (item.RequesterRole == "P") {
                                              @:badge-success
                                              } else if (item.RequesterRole == "S") {
                                              @:badge-danger
                                                }
                                                else{
                                                @:badge-secondary
                                               }
                                              ">
                                        @Html.DisplayFor(m => item.RequesterRoleToShow)
                                    </span>
                                    @Html.DisplayFor(m => item.RequesterName)
                                </span>
                                <span class="text-primary float-right">@Html.DisplayFor(m => item.RequestDate)</span>
                                <p>@Html.Raw(item.Record)</p>
                            </li>
                        }
                    </ul>
                </div>
            </div>

        </div>
    </div>

</div>
